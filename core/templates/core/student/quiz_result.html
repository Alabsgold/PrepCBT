{% extends 'core/layouts/base_glass.html' %}

{% block title %}Quiz Result - PrepCBT{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto text-center pt-8 pb-12">
    <div class="glass-panel rounded-2xl p-8 md:p-12 shadow-2xl relative overflow-hidden">

        <!-- Decoration -->
        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>

        <h3 class="text-3xl font-bold text-white mb-2">Quiz Results</h3>
        <p class="text-gray-400 text-lg mb-8">{{ quiz.title }}</p>

        <!-- Score Circle -->
        <div class="relative w-48 h-48 mx-auto mb-10 flex items-center justify-center">
            <!-- Outer glow -->
            <div
                class="absolute inset-0 bg-indigo-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-pulse">
            </div>

            <svg class="transform -rotate-90 w-full h-full" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="8" />
                <circle cx="50" cy="50" r="45" fill="none" stroke="{{ performance.color_hex }}" stroke-width="8"
                    stroke-dasharray="{{ result.score|floatformat:0 }} 100" stroke-linecap="round"
                    class="transition-all duration-1000 ease-out"
                    style="stroke-dasharray: {{ result.score }} 283; stroke-dashoffset: 0;" />
                <!-- Note: 2*pi*r = 2*3.14*45 = ~283 -->
            </svg>
            <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span class="text-5xl font-bold text-white">{{ result.score|floatformat:1 }}%</span>
                <span class="text-xs text-gray-400 uppercase tracking-wider mt-1">Score</span>
            </div>
        </div>

        <!-- Performance Message -->
        <div class="mb-10 p-6 rounded-xl border backdrop-blur-md"
            style="background-color: {{ performance.color_hex }}20; border-color: {{ performance.color_hex }}40;">
            <h4 class="text-2xl font-bold text-white mb-1">{{ performance.message }}</h4>
            <p class="text-gray-300">You scored {{ result.score|floatformat:1 }}% on this assessment.</p>
        </div>

        <div class="flex flex-col sm:flex-row justify-center gap-4">
            <!-- Review link temporarily disabled until review view is fixed -->
            <!-- 
            <a href="{# url 'review_quiz' quiz.id #}" class="px-8 py-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 text-white transition-all">
                Review Answers
            </a>
            -->
            <a href="{% url 'student_dashboard' %}"
                class="px-8 py-3 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white font-bold shadow-lg transform transition hover:scale-105 duration-300">
                Back to Dashboard
            </a>
        </div>

        <div class="mt-8 text-sm text-gray-500">
            Completed on: {{ result.completed_on|date:"F j, Y, g:i a" }}
        </div>
    </div>
</div>
{% endblock %}